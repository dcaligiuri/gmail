{"version":3,"file":"modal.js","sourceRoot":"","sources":["../../../src/lib/providers/modal.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  ComponentRef,\n  TemplateRef,\n  ReflectiveInjector,\n  ResolvedReflectiveProvider, Type\n} from '@angular/core';\n\nimport { Overlay } from '../overlay/index';\nimport { Class, Maybe } from '../framework/utils';\nimport { OverlayConfig, ContainerContent } from '../models/tokens';\nimport { DialogRef } from '../models/dialog-ref';\nimport { ModalControllingContextBuilder } from '../models/overlay-context';\n\nexport class UnsupportedDropInError extends Error {\n  constructor(dropInName: string) {\n    super();\n    this.message = `Unsupported Drop-In ${dropInName}`;\n  }\n}\n\nexport abstract class Modal {\n  constructor(public overlay: Overlay) { }\n\n\n  alert(): ModalControllingContextBuilder<any> {\n    throw new UnsupportedDropInError('alert');\n  }\n\n  prompt(): ModalControllingContextBuilder<any> {\n    throw new UnsupportedDropInError('prompt');\n  }\n\n  confirm(): ModalControllingContextBuilder<any> {\n    throw new UnsupportedDropInError('confirm');\n  }\n\n  /**\n   * Opens a modal window inside an existing component.\n   * @param content The content to display, either string, template ref or a component.\n   * @param config Additional settings.\n   * @returns {Promise<DialogRef>}\n   */\n  open(content: ContainerContent, config?: OverlayConfig): Promise<DialogRef<any>> {\n    config = config || {} as any;\n    try {\n      let dialogs = this.overlay.open(config, this.constructor);\n\n      if (dialogs.length > 1) {\n        console.warn(`Attempt to open more then 1 overlay detected.\n        Multiple modal copies are not supported at the moment, \n        only the first viewContainer will display.`);\n      }\n      // TODO:  Currently supporting 1 view container, hence working on dialogs[0].\n      //        upgrade to multiple containers.\n      return Promise.resolve(\n        this.create(dialogs[0], content, config.bindings)\n      );\n\n    } catch (e) {\n      return Promise.reject<DialogRef<any>>(e);\n    }\n\n  }\n\n  /**\n   * A Hook that enables derived classes to add content to the overlay.\n   * @param dialogRef\n   * @param type\n   * @param bindings\n   * @returns {MaybeDialogRef<any>}\n   */\n  protected abstract create(dialogRef: DialogRef<any>,\n                            type: ContainerContent,\n                            bindings?: ResolvedReflectiveProvider[]): Maybe<DialogRef<any>>;\n\n\n  protected createBackdrop<T>(dialogRef: DialogRef<any>, BackdropComponent: Class<T>): ComponentRef<T> {\n    const b = ReflectiveInjector.resolve([{provide: DialogRef, useValue: dialogRef}]);\n    return dialogRef.overlayRef.instance.addComponent<T>(BackdropComponent, b);\n  }\n\n  protected createContainer<T>(\n    dialogRef: DialogRef<any>,\n    ContainerComponent: Class<T>,\n    content: string | TemplateRef<any> | Type<any>,\n    bindings?: ResolvedReflectiveProvider[]): ComponentRef<T> {\n\n    const b = ReflectiveInjector.resolve([{provide: DialogRef, useValue: dialogRef}])\n      .concat(bindings || []);\n\n    let nodes: any[] = dialogRef.overlayRef.instance.getProjectables(content, b);\n    return dialogRef.overlayRef.instance.addComponent<T>(ContainerComponent, b, nodes);\n  }\n\n\n  /**\n   * A helper function for derived classes to create backdrop & container\n   * @param dialogRef\n   * @param backdrop\n   * @param container\n   * @returns { backdropRef: ComponentRef<B>, containerRef: ComponentRef<C> }\n   *\n   * @deprecated use createBackdrop and createContainer instead\n   */\n  protected createModal<B, C>(dialogRef: DialogRef<any>, backdrop: Class<B>, container: Class<C>)\n                                : { backdropRef: ComponentRef<B>, containerRef: ComponentRef<C> } {\n    const b = ReflectiveInjector.resolve([{provide: DialogRef, useValue: dialogRef}]);\n\n    return {\n      backdropRef: dialogRef.overlayRef.instance.addComponent<B>(backdrop, b),\n      containerRef: dialogRef.overlayRef.instance.addComponent<C>(container, b)\n    };\n  }\n\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}